package ee.ttu.automaattestimine.main;

import org.json.JSONObject;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.BeforeEach;
import java.io.IOException;
import java.nio.file.*;
import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.Mockito.*;

class WeatherReportTest {
    WeatherReport weather;
    Writer writer;
    Reader reader;
    WeatherRequest weatherRequest;

    @BeforeEach
    void testBeforeEach(){
        writer = new Writer();
        reader = new Reader();
        weatherRequest = new WeatherRequest();
        weather = new WeatherReport("Tallinn", "Metric", writer, weatherRequest);
    }

    @Test
    void testFileExistAfterWrite(){
        weather.writeReport();
        if (Files.notExists(Paths.get("D:\\Backup Miwka\\IdeaProjects\\WeatherForecast\\src\\ee\\ttu\\automaattestimine\\main\\Tallinn.txt"))){
            fail("File was not created");
        }
    }

    @Test
    void testGetJSONRequestTypeFind() {
        try {
            assertNotNull(weather.getJSON("find"));
        } catch (IOException e) {
            fail("It is Null");
        }
    }

    @Test
    void testGetJSONRequestTypeForecast() {
        try {
            assertNotNull(weather.getJSON("forecast"));
        } catch (IOException e) {
            fail("It is Null");
        }
    }

    @Test
    void testGetCityName() {
        assertTrue(weather.getCityName().matches("[a-zA-Z]+"));
    }

    @Test
    void testGetMeasuringUntis() {
        assertTrue(weather.getMeasuringUntis().matches("[a-zA-Z]+"));
    }

    @Test
    void testGetCurrentTemperature() {
        assertTrue(weather.getCurrentTemperature() >= 0 || weather.getCurrentTemperature() <= 0);
    }

    @Test
    void testMockFileWrite() {
        writer = mock(Writer.class);
        weather = new WeatherReport("Helsinki", "Metric", writer, weatherRequest);
        when(writer.write(any(), any())).thenReturn(true);
        weather.writeReport();
        if (!Files.notExists(Paths.get("D:\\Backup Miwka\\IdeaProjects\\WeatherForecast\\src\\ee\\ttu\\automaattestimine\\main\\Helsinki.txt"))){
            fail("File was not created");
        }
        verify(writer).write(any(), any());
    }

    @Test
    void testMockFileRead() {
        reader = mock(Reader.class);
        when(reader.read(any())).thenReturn("Stockholm\nOslo");
        Reports reports = new Reports(writer, reader, weatherRequest);
        reports.generateReportFiles();
        if (Files.notExists(Paths.get("D:\\Backup Miwka\\IdeaProjects\\WeatherForecast\\src\\ee\\ttu\\automaattestimine\\main\\Stockholm.txt"))
                || Files.notExists(Paths.get("D:\\Backup Miwka\\IdeaProjects\\WeatherForecast\\src\\ee\\ttu\\automaattestimine\\main\\Oslo.txt"))){
            fail("File was not created");
        }
        verify(reader).read(any());
    }

    @Test
    void testMockExternalAPI() throws IOException {
        weatherRequest = mock(WeatherRequest.class);
        when(weatherRequest.request(any())).thenReturn(new JSONObject("{\"cod\":\"200\",\"message\":0.0026,\"cnt\":40,\"list\":[{\"dt\":1513609200,\"main\":{\"temp\":2.21,\"temp_min\":2.21,\"temp_max\":2.51,\"pressure\":1036.01,\"sea_level\":1038.29,\"grnd_level\":1036.01,\"humidity\":100,\"temp_kf\":-0.3},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":5.4,\"deg\":214.501},\"rain\":{\"3h\":0.0175},\"snow\":{\"3h\":0.006},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-18 15:00:00\"},{\"dt\":1513620000,\"main\":{\"temp\":2.02,\"temp_min\":2.02,\"temp_max\":2.22,\"pressure\":1036.8,\"sea_level\":1039.03,\"grnd_level\":1036.8,\"humidity\":100,\"temp_kf\":-0.2},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":5.54,\"deg\":223.003},\"rain\":{\"3h\":0.03},\"snow\":{\"3h\":0.053},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-18 18:00:00\"},{\"dt\":1513630800,\"main\":{\"temp\":2.16,\"temp_min\":2.16,\"temp_max\":2.26,\"pressure\":1036.94,\"sea_level\":1039.16,\"grnd_level\":1036.94,\"humidity\":100,\"temp_kf\":-0.1},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5.21,\"deg\":222.006},\"rain\":{\"3h\":0.125},\"snow\":{\"3h\":0.104},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-18 21:00:00\"},{\"dt\":1513641600,\"main\":{\"temp\":2.28,\"temp_min\":2.28,\"temp_max\":2.28,\"pressure\":1036.99,\"sea_level\":1039.31,\"grnd_level\":1036.99,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":4.44,\"deg\":222.5},\"rain\":{\"3h\":0.135},\"snow\":{\"3h\":0.02275},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-19 00:00:00\"},{\"dt\":1513652400,\"main\":{\"temp\":2.58,\"temp_min\":2.58,\"temp_max\":2.58,\"pressure\":1037.57,\"sea_level\":1039.94,\"grnd_level\":1037.57,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":2.51,\"deg\":228.001},\"rain\":{\"3h\":0.04},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-19 03:00:00\"},{\"dt\":1513663200,\"main\":{\"temp\":2.3,\"temp_min\":2.3,\"temp_max\":2.3,\"pressure\":1038.33,\"sea_level\":1040.75,\"grnd_level\":1038.33,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":1.11,\"deg\":177.501},\"rain\":{\"3h\":0.035},\"snow\":{\"3h\":0.00125},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-19 06:00:00\"},{\"dt\":1513674000,\"main\":{\"temp\":1.61,\"temp_min\":1.61,\"temp_max\":1.61,\"pressure\":1039.53,\"sea_level\":1041.96,\"grnd_level\":1039.53,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":44},\"wind\":{\"speed\":1.04,\"deg\":152.002},\"rain\":{\"3h\":0.025},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-19 09:00:00\"},{\"dt\":1513684800,\"main\":{\"temp\":2.7,\"temp_min\":2.7,\"temp_max\":2.7,\"pressure\":1039.89,\"sea_level\":1042.22,\"grnd_level\":1039.89,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":48},\"wind\":{\"speed\":0.6,\"deg\":25.5005},\"rain\":{\"3h\":0.01},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-19 12:00:00\"},{\"dt\":1513695600,\"main\":{\"temp\":1.12,\"temp_min\":1.12,\"temp_max\":1.12,\"pressure\":1040.57,\"sea_level\":1042.81,\"grnd_level\":1040.57,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":1.61,\"deg\":79.0026},\"rain\":{\"3h\":0.065},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-19 15:00:00\"},{\"dt\":1513706400,\"main\":{\"temp\":0.63,\"temp_min\":0.63,\"temp_max\":0.63,\"pressure\":1041.01,\"sea_level\":1043.3,\"grnd_level\":1041.01,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":56},\"wind\":{\"speed\":2.06,\"deg\":114.507},\"rain\":{\"3h\":0.06},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-19 18:00:00\"},{\"dt\":1513717200,\"main\":{\"temp\":0.87,\"temp_min\":0.87,\"temp_max\":0.87,\"pressure\":1041.13,\"sea_level\":1043.42,\"grnd_level\":1041.13,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":68},\"wind\":{\"speed\":2.57,\"deg\":154.004},\"rain\":{\"3h\":0.035},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-19 21:00:00\"},{\"dt\":1513728000,\"main\":{\"temp\":1.75,\"temp_min\":1.75,\"temp_max\":1.75,\"pressure\":1041.04,\"sea_level\":1043.33,\"grnd_level\":1041.04,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":68},\"wind\":{\"speed\":3.36,\"deg\":176.501},\"rain\":{\"3h\":0.035},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-20 00:00:00\"},{\"dt\":1513738800,\"main\":{\"temp\":2.4,\"temp_min\":2.4,\"temp_max\":2.4,\"pressure\":1040.48,\"sea_level\":1042.73,\"grnd_level\":1040.48,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":4.41,\"deg\":190.008},\"rain\":{\"3h\":0.06},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-20 03:00:00\"},{\"dt\":1513749600,\"main\":{\"temp\":3.6,\"temp_min\":3.6,\"temp_max\":3.6,\"pressure\":1040.01,\"sea_level\":1042.28,\"grnd_level\":1040.01,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5,\"deg\":199.001},\"rain\":{\"3h\":0.13},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-20 06:00:00\"},{\"dt\":1513760400,\"main\":{\"temp\":4.45,\"temp_min\":4.45,\"temp_max\":4.45,\"pressure\":1039.68,\"sea_level\":1042.08,\"grnd_level\":1039.68,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5.46,\"deg\":207.005},\"rain\":{\"3h\":0.29},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-20 09:00:00\"},{\"dt\":1513771200,\"main\":{\"temp\":5.04,\"temp_min\":5.04,\"temp_max\":5.04,\"pressure\":1038.91,\"sea_level\":1041.3,\"grnd_level\":1038.91,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5.01,\"deg\":226.501},\"rain\":{\"3h\":0.2},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-20 12:00:00\"},{\"dt\":1513782000,\"main\":{\"temp\":5.26,\"temp_min\":5.26,\"temp_max\":5.26,\"pressure\":1038.06,\"sea_level\":1040.29,\"grnd_level\":1038.06,\"humidity\":95,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":4.57,\"deg\":247.007},\"rain\":{\"3h\":0.205},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-20 15:00:00\"},{\"dt\":1513792800,\"main\":{\"temp\":5.42,\"temp_min\":5.42,\"temp_max\":5.42,\"pressure\":1037.28,\"sea_level\":1039.53,\"grnd_level\":1037.28,\"humidity\":98,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5.16,\"deg\":252.002},\"rain\":{\"3h\":0.08},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-20 18:00:00\"},{\"dt\":1513803600,\"main\":{\"temp\":5.8,\"temp_min\":5.8,\"temp_max\":5.8,\"pressure\":1035.93,\"sea_level\":1038.18,\"grnd_level\":1035.93,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5.51,\"deg\":255.506},\"rain\":{\"3h\":0.14},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-20 21:00:00\"},{\"dt\":1513814400,\"main\":{\"temp\":6.19,\"temp_min\":6.19,\"temp_max\":6.19,\"pressure\":1034.72,\"sea_level\":1037,\"grnd_level\":1034.72,\"humidity\":96,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5.62,\"deg\":267.001},\"rain\":{\"3h\":0.71},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-21 00:00:00\"},{\"dt\":1513825200,\"main\":{\"temp\":6.47,\"temp_min\":6.47,\"temp_max\":6.47,\"pressure\":1033.58,\"sea_level\":1035.9,\"grnd_level\":1033.58,\"humidity\":95,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":5.8,\"deg\":277.501},\"rain\":{\"3h\":0.24},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-21 03:00:00\"},{\"dt\":1513836000,\"main\":{\"temp\":5.11,\"temp_min\":5.11,\"temp_max\":5.11,\"pressure\":1032.73,\"sea_level\":1034.94,\"grnd_level\":1032.73,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":20},\"wind\":{\"speed\":5.9,\"deg\":294.002},\"rain\":{\"3h\":0.05},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-21 06:00:00\"},{\"dt\":1513846800,\"main\":{\"temp\":4.25,\"temp_min\":4.25,\"temp_max\":4.25,\"pressure\":1032.31,\"sea_level\":1034.51,\"grnd_level\":1032.31,\"humidity\":99,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":6.54,\"deg\":291.001},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-21 09:00:00\"},{\"dt\":1513857600,\"main\":{\"temp\":5.13,\"temp_min\":5.13,\"temp_max\":5.13,\"pressure\":1031.46,\"sea_level\":1033.79,\"grnd_level\":1031.46,\"humidity\":95,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02d\"}],\"clouds\":{\"all\":12},\"wind\":{\"speed\":7.96,\"deg\":303},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-21 12:00:00\"},{\"dt\":1513868400,\"main\":{\"temp\":5.4,\"temp_min\":5.4,\"temp_max\":5.4,\"pressure\":1031.96,\"sea_level\":1034.21,\"grnd_level\":1031.96,\"humidity\":94,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":9.21,\"deg\":317.002},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-21 15:00:00\"},{\"dt\":1513879200,\"main\":{\"temp\":5.37,\"temp_min\":5.37,\"temp_max\":5.37,\"pressure\":1032.59,\"sea_level\":1034.89,\"grnd_level\":1032.59,\"humidity\":94,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":9.16,\"deg\":312.002},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-21 18:00:00\"},{\"dt\":1513890000,\"main\":{\"temp\":4.96,\"temp_min\":4.96,\"temp_max\":4.96,\"pressure\":1033.84,\"sea_level\":1036.13,\"grnd_level\":1033.84,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":9.72,\"deg\":313},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-21 21:00:00\"},{\"dt\":1513900800,\"main\":{\"temp\":4.85,\"temp_min\":4.85,\"temp_max\":4.85,\"pressure\":1034.85,\"sea_level\":1037.07,\"grnd_level\":1034.85,\"humidity\":96,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":32},\"wind\":{\"speed\":9.26,\"deg\":309.002},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-22 00:00:00\"},{\"dt\":1513911600,\"main\":{\"temp\":5.17,\"temp_min\":5.17,\"temp_max\":5.17,\"pressure\":1035.65,\"sea_level\":1037.86,\"grnd_level\":1035.65,\"humidity\":94,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":9.86,\"deg\":312.505},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-22 03:00:00\"},{\"dt\":1513922400,\"main\":{\"temp\":5.14,\"temp_min\":5.14,\"temp_max\":5.14,\"pressure\":1036.64,\"sea_level\":1038.95,\"grnd_level\":1036.64,\"humidity\":94,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":9.51,\"deg\":311.503},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-22 06:00:00\"},{\"dt\":1513933200,\"main\":{\"temp\":5.35,\"temp_min\":5.35,\"temp_max\":5.35,\"pressure\":1037.25,\"sea_level\":1039.56,\"grnd_level\":1037.25,\"humidity\":93,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":9.4,\"deg\":300.503},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-22 09:00:00\"},{\"dt\":1513944000,\"main\":{\"temp\":6.25,\"temp_min\":6.25,\"temp_max\":6.25,\"pressure\":1037.21,\"sea_level\":1039.52,\"grnd_level\":1037.21,\"humidity\":94,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":10.42,\"deg\":303.006},\"rain\":{\"3h\":0.01},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-22 12:00:00\"},{\"dt\":1513954800,\"main\":{\"temp\":6.34,\"temp_min\":6.34,\"temp_max\":6.34,\"pressure\":1037.09,\"sea_level\":1039.37,\"grnd_level\":1037.09,\"humidity\":92,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":9.97,\"deg\":302.005},\"rain\":{\"3h\":0.0099999999999998},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-22 15:00:00\"},{\"dt\":1513965600,\"main\":{\"temp\":5.98,\"temp_min\":5.98,\"temp_max\":5.98,\"pressure\":1037.16,\"sea_level\":1039.3,\"grnd_level\":1037.16,\"humidity\":94,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":8.86,\"deg\":294.001},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-22 18:00:00\"},{\"dt\":1513976400,\"main\":{\"temp\":5.58,\"temp_min\":5.58,\"temp_max\":5.58,\"pressure\":1036.16,\"sea_level\":1038.33,\"grnd_level\":1036.16,\"humidity\":93,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":8.01,\"deg\":284.007},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-22 21:00:00\"},{\"dt\":1513987200,\"main\":{\"temp\":5.49,\"temp_min\":5.49,\"temp_max\":5.49,\"pressure\":1033.59,\"sea_level\":1035.83,\"grnd_level\":1033.59,\"humidity\":97,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":7.29,\"deg\":263.503},\"rain\":{\"3h\":0.32},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-23 00:00:00\"},{\"dt\":1513998000,\"main\":{\"temp\":6.15,\"temp_min\":6.15,\"temp_max\":6.15,\"pressure\":1029.9,\"sea_level\":1032.18,\"grnd_level\":1029.9,\"humidity\":96,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":8.51,\"deg\":258.5},\"rain\":{\"3h\":0.41},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-23 03:00:00\"},{\"dt\":1514008800,\"main\":{\"temp\":6.77,\"temp_min\":6.77,\"temp_max\":6.77,\"pressure\":1025.99,\"sea_level\":1028.17,\"grnd_level\":1025.99,\"humidity\":93,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":9.66,\"deg\":257.501},\"rain\":{\"3h\":0.33},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-12-23 06:00:00\"},{\"dt\":1514019600,\"main\":{\"temp\":7.63,\"temp_min\":7.63,\"temp_max\":7.63,\"pressure\":1023.26,\"sea_level\":1025.5,\"grnd_level\":1023.26,\"humidity\":92,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":10.79,\"deg\":267.5},\"rain\":{\"3h\":0.55},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-23 09:00:00\"},{\"dt\":1514030400,\"main\":{\"temp\":8.17,\"temp_min\":8.17,\"temp_max\":8.17,\"pressure\":1020.52,\"sea_level\":1022.68,\"grnd_level\":1020.52,\"humidity\":91,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":11.34,\"deg\":269},\"rain\":{\"3h\":0.33},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-12-23 12:00:00\"}],\"city\":{\"id\":2621941,\"name\":\"Copenhagen\",\"coord\":{\"lat\":55.6867,\"lon\":12.5701},\"country\":\"DK\",\"population\":99038}}"));
        Reports reports = new Reports(writer, reader, weatherRequest);
        reports.generateReportFiles();
        if (!Files.notExists(Paths.get("D:\\Backup Miwka\\IdeaProjects\\WeatherForecast\\src\\ee\\ttu\\automaattestimine\\main\\Copenhagen.txt"))){
            fail("File was not created");
        }
        verify(weatherRequest, atLeastOnce()).request(any());
    }
}